<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>sesameeg.Sesame &#8212; sesameeg 0.0.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=284a2d1d" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../_static/documentation_options.js?v=e3a6060d"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/copybutton.js?v=26522df0"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sesameeg.mne.prepare_sesame" href="sesameeg.mne.prepare_sesame.html" />
    <link rel="prev" title="API Reference" href="../api.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          sesameeg</a>
        <span class="navbar-text navbar-version pull-left"><b>0.0.2</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../api.html">API</a></li>
                <li><a href="../auto_examples/index.html">Examples</a></li>
                <li><a href="../explanation_algorithm.html">Model</a></li>
                <li><a href="https://github.com/pybees/sesameeg">GitHub</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="sesameeg-sesame">
<h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">sesameeg</span></code>.Sesame<a class="headerlink" href="#sesameeg-sesame" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sesameeg.Sesame">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sesameeg.</span></span><span class="sig-name descname"><span class="pre">Sesame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_parts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip_mom_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_ori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neigh_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_locs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hyper_q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n_dips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fourier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame" title="Link to this definition">¶</a></dt>
<dd><p>Sequential Semi-Analytic Monte-Carlo Estimator (SESAME).</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>source_space</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_verts, 3)</span></dt><dd><p>The coordinates of the points in the brain discretization.</p>
</dd>
<dt><strong>lead_field</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_sens, n_comp*n_verts)</span></dt><dd><p>The lead field matrix. (if <code class="docutils literal notranslate"><span class="pre">fixed_ori=True</span></code> it must be <code class="docutils literal notranslate"><span class="pre">n_comp</span> <span class="pre">=</span> <span class="pre">1</span></code>;  if <code class="docutils literal notranslate"><span class="pre">fixed_ori=False</span></code>
it must be <code class="docutils literal notranslate"><span class="pre">n_comp</span> <span class="pre">=</span> <span class="pre">3</span></code>)</p>
</dd>
<dt><strong>data</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_sens, n_ist)</span></dt><dd><p>The MEEG data; <code class="docutils literal notranslate"><span class="pre">n_sens</span></code> is the number of sensors and
<code class="docutils literal notranslate"><span class="pre">n_ist</span></code> is the number of time-points or of frequencies.</p>
</dd>
<dt><strong>n_parts</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The number of particles forming the empirical pdf.</p>
</dd>
<dt><strong>s_min</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The first analyzed sample in the data array.</p>
</dd>
<dt><strong>s_max</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The last analyzed sample in the data array.</p>
</dd>
<dt><strong>n_matrix</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, shape (n_verts, n_max_neigh) | None</span></dt><dd><p>The set of neighbours of each point in the brain discretization. If None, it is automatically computed.
<code class="docutils literal notranslate"><span class="pre">n_max_neigh</span></code> is the cardinality of the biggest set.</p>
</dd>
<dt><strong>np_matrix</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_verts, n_max_neigh) | None</span></dt><dd><p>The neighbours’ probabilities. If None, it is automatically computed.</p>
</dd>
<dt><strong>noise_std</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | None</span></dt><dd><p>The standard deviation of the noise distribution.
If None, it is estimated from the data.</p>
</dd>
<dt><strong>dip_mom_std</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | None</span></dt><dd><p>The standard deviation of the prior pdf on the dipole moment.
If None, it is estimated from the forward model and the data.</p>
</dd>
<dt><strong>fixed_ori</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True, the forward solution is assumed to be computed in the surface-based source coordinate system.</p>
</dd>
<dt><strong>radius</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | None</span></dt><dd><p>The maximum distance in cm between two neighbouring vertices
of the brain discretization. If None, <code class="docutils literal notranslate"><span class="pre">radius</span></code> is set to 1 cm.</p>
</dd>
<dt><strong>neigh_std</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | None</span></dt><dd><p>The standard deviation of the probability distribution of
neighbours. If None, <code class="docutils literal notranslate"><span class="pre">neighb_std</span></code> is set to radius/2.</p>
</dd>
<dt><strong>prior_locs</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_vert) | None</span></dt><dd><p>The prior probability of source location. If None, a uniform prior probability is used.
Default is None.</p>
</dd>
<dt><strong>subsample</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | None</span></dt><dd><p>The step used to subsample the data. If None no subsampling is
applied.</p>
</dd>
<dt><strong>hyper_q</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True, a hyperprior pdf on the dipole moment std will be used.</p>
</dd>
<dt><strong>top_min</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | None</span></dt><dd><p>First topography to be included in the segment of data to be analyzed.
It is meant to be expressed either in seconds in the time domain or
in Hertz in the frequency domain.
If None, it is set to the first topography of the input data.</p>
</dd>
<dt><strong>top_max</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> | None</span></dt><dd><p>Last topography to be included in the segment of data to be analyzed.
It is meant to be expressed either in seconds in the time domain or
in Hertz in the frequency domain.
If None, it is set to the last topography of the input data.</p>
</dd>
<dt><strong>lam</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The parameter of the Poisson prior pdf on the number of dipoles.</p>
</dd>
<dt><strong>max_n_dips</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The maximum number of dipoles allowed in a particle.</p>
</dd>
<dt><strong>fourier</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True, data are converted to the frequency domain.</p>
</dd>
<dt><strong>verbose</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True, increase verbose level.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments are passed to the Sesame constructor.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>dip_mom_std</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The standard deviation of the prior on the dipole moment.</p>
</dd>
<dt><strong>distance_matrix</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_verts x n_verts)</span></dt><dd><p>The Euclidean distance between the points in the
brain discretization.</p>
</dd>
<dt><strong>est_dip_moms</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_ist x (n_comp*est_n_dips[-1])) | None</span></dt><dd><p>The sources’ moments estimated at the last iteration. (n_comp = 1, if fixed orientation, 3, if free orientation)
If None, moments can be estimated by calling <a class="reference internal" href="#sesameeg.Sesame.compute_dip_mom" title="sesameeg.Sesame.compute_dip_mom"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute_dip_mom()</span></code></a></p>
</dd>
<dt><strong>est_locs</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The source space grid points indices in which a source is estimated.</p>
</dd>
<dt><strong>est_n_dips</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The estimated number of dipoles.</p>
</dd>
<dt><strong>fourier</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True, data are in the frequency domain.</p>
</dd>
<dt><strong>hyper_q</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True use hyperprior on dipole moment std.</p>
</dd>
<dt><strong>lam</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The parameter of the Poisson prior pdf on the number of dipoles.</p>
</dd>
<dt><strong>lead_field</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_sens x n_comp*n_verts)</span></dt><dd><p>The leadfield matrix. (<code class="docutils literal notranslate"><span class="pre">n_comp</span> <span class="pre">=</span> <span class="pre">1</span></code> if <code class="docutils literal notranslate"><span class="pre">fixed_ori=True</span></code>; <code class="docutils literal notranslate"><span class="pre">n_comp</span> <span class="pre">=</span> <span class="pre">3</span></code> if <code class="docutils literal notranslate"><span class="pre">fixed_ori=False</span></code>)</p>
</dd>
<dt><strong>max_n_dips</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The maximum number of dipoles allowed in a particle.</p>
</dd>
<dt><strong>model_sel</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The model selection, i.e. the posterior distribution on the number
of dipoles.</p>
</dd>
<dt><strong>n_verts</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The number of points forming the brain discretization.</p>
</dd>
<dt><strong>n_parts</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The number of particles forming the empirical pdf.</p>
</dd>
<dt><strong>neigh</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, shape (n_vert, n_max_neigh)</span></dt><dd><p>The set of neighbours of each point in the brain discretization.
n_max_neigh is the cardinality of the biggest set.</p>
</dd>
<dt><strong>neigh_p</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_vert, n_max_neigh)</span></dt><dd><p>The neighbours’ probabilities.</p>
</dd>
<dt><strong>neigh_std</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The standard deviation used to compute the neigh_p matrix.</p>
</dd>
<dt><strong>noise_std</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The standard deviation of the noise distribution.</p>
</dd>
<dt><strong>pmap</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (est_n_dips, n_verts)</span></dt><dd><p>Posterior probability map.</p>
</dd>
<dt><strong>posterior</strong><span class="classifier">instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">EmpPdf</span></code></span></dt><dd><p>The empirical pdf approximated by the particles at each iteration.</p>
</dd>
<dt><strong>prior_locs</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_verts, ) | None</span></dt><dd><p>The prior probability of active source locations. If None, each source space grid point is assigned a
uniform prior probability.</p>
</dd>
<dt><strong>r_data</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_sens, n_ist)</span></dt><dd><p>The real part of the data; n_sens is the number of sensors and
n_ist is the number of time-points or of frequencies.</p>
</dd>
<dt><strong>radius</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The radius used to compute the neighbours.</p>
</dd>
<dt><strong>_resample_it</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The iterations during which a resampling step has been performed</p>
</dd>
<dt><strong>s_min</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The first sample of the segment of data that are analyzed.</p>
</dd>
<dt><strong>s_max</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The last sample of the segment of data that are analyzed.</p>
</dd>
<dt><strong>source_space</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, shape (n_verts, 3)</span></dt><dd><p>The coordinates of the points in the brain discretization.</p>
</dd>
<dt><strong>subsample</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | None</span></dt><dd><p>The step used to subsample the data.</p>
</dd>
<dt><strong>data_times</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></dt><dd><p>Time vector in seconds. Only when instantiated by means of <a class="reference internal" href="sesameeg.mne.prepare_sesame.html#sesameeg.mne.prepare_sesame" title="sesameeg.mne.prepare_sesame"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_sesame()</span></code></a>
and when <code class="docutils literal notranslate"><span class="pre">fourier=False</span></code></p>
</dd>
<dt><strong>data_freqs</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></dt><dd><p>Frequency vector in Hertz. Only when instantiated by means of <a class="reference internal" href="sesameeg.mne.prepare_sesame.html#sesameeg.mne.prepare_sesame" title="sesameeg.mne.prepare_sesame"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_sesame()</span></code></a>
and when <code class="docutils literal notranslate"><span class="pre">fourier=True</span></code></p>
</dd>
<dt><strong>forward</strong><span class="classifier">instance of <a class="reference external" href="https://mne.tools/stable/generated/mne.Forward.html#mne.Forward" title="(in MNE v1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Forward</span></code></a></span></dt><dd><p>The forward solution. Only when instantiated by means of <a class="reference internal" href="sesameeg.mne.prepare_sesame.html#sesameeg.mne.prepare_sesame" title="sesameeg.mne.prepare_sesame"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_sesame()</span></code></a></p>
</dd>
<dt><strong>subject</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>Subject name in Freesurfer subjects dir. Only when instantiated by means
of <a class="reference internal" href="sesameeg.mne.prepare_sesame.html#sesameeg.mne.prepare_sesame" title="sesameeg.mne.prepare_sesame"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_sesame()</span></code></a>.</p>
</dd>
<dt><strong>subjects_dir</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>If not None, this directory will be used as the subjects directory instead of the value set using
the SUBJECTS_DIR environment variable. Only when instantiated by means
of <a class="reference internal" href="sesameeg.mne.prepare_sesame.html#sesameeg.mne.prepare_sesame" title="sesameeg.mne.prepare_sesame"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_sesame()</span></code></a></p>
</dd>
<dt><strong>trans_matrix</strong><span class="classifier">instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Transform</span></code></span></dt><dd><p>MRI&lt;-&gt;Head coordinate transformation. Only when instantiated by
means of <a class="reference internal" href="sesameeg.mne.prepare_sesame.html#sesameeg.mne.prepare_sesame" title="sesameeg.mne.prepare_sesame"><code class="xref py py-func docutils literal notranslate"><span class="pre">prepare_sesame()</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.apply_sesame">
<span class="sig-name descname"><span class="pre">apply_sesame</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimate_dip_mom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.apply_sesame"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.apply_sesame" title="Link to this definition">¶</a></dt>
<dd><p>Apply SESAME on MEEG data and compute point estimates.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>estimate_all</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True compute the posterior probability map and estimate the
number of dipoles and their locations at each iteration.
If False compute the above quantities only at the last
iteration.</p>
</dd>
<dt><strong>estimate_dip_mom</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True compute a point-estimate of the dipole moment at the
last iteration.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.compute_dip_mom">
<span class="sig-name descname"><span class="pre">compute_dip_mom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">est_locs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.compute_dip_mom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.compute_dip_mom" title="Link to this definition">¶</a></dt>
<dd><p>Compute a point estimate for the dipole moments.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>est_locs</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The estimated source locations.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.compute_stc">
<span class="sig-name descname"><span class="pre">compute_stc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.compute_stc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.compute_stc" title="Link to this definition">¶</a></dt>
<dd><p>Compute and export in an .stc file the posterior pdf
<img class="math" src="../_images/math/109384318501d9cf004610827092db3a029198df.png" alt="p(r|\mathbf{y}, \hat{n}_D)"/>, being <img class="math" src="../_images/math/a1e6a549160d92b884d0de79b35f8386f465dbca.png" alt="\hat{n}_D"/>
the estimated number of sources.
For each point <img class="math" src="../_images/math/79a3d439d28652c547386f39b555d90d3aaf102d.png" alt="r"/> in the brain discretization,
<img class="math" src="../_images/math/109384318501d9cf004610827092db3a029198df.png" alt="p(r|\mathbf{y}, \hat{n}_D)"/> is the probability of a
source being located in <img class="math" src="../_images/math/79a3d439d28652c547386f39b555d90d3aaf102d.png" alt="r"/>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>subject</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The subject name.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>stc</strong><span class="classifier"><a class="reference external" href="https://mne.tools/stable/generated/mne.SourceEstimate.html#mne.SourceEstimate" title="(in MNE v1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">SourceEstimate</span></code></a> | <a class="reference external" href="https://mne.tools/stable/generated/mne.VolSourceEstimate.html#mne.VolSourceEstimate" title="(in MNE v1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">VolSourceEstimate</span></code></a></span></dt><dd><p>The source estimate object containing the posterior map of the
dipoles’ location.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.goodness_of_fit">
<span class="sig-name descname"><span class="pre">goodness_of_fit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.goodness_of_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.goodness_of_fit" title="Link to this definition">¶</a></dt>
<dd><p>Evaluate the estimated configuration of dipoles. The goodness
of fit (GOF) with the recorded data is defined as</p>
<div class="math">
<p><img src="../_images/math/5a2351437d5bacfbcbc65949602580dbd37aba89.png" alt="GOF = \frac{\| \mathbf{y} - \hat{\mathbf{y}} \|}
{ \|\mathbf{y}\|}"/></p>
</div><p>where <img class="math" src="../_images/math/b04f62e21c4cd0ae0183708ab43bd04d6a0579f7.png" alt="\mathbf{y}"/> is the recorded data,
<img class="math" src="../_images/math/afdafb8ad0bb46514231046f54b575c0e367ac16.png" alt="\hat{\mathbf{y}}"/> is the field generated by the
estimated configuration of dipoles, and <img class="math" src="../_images/math/83fb8c3a7a8dbada52b296701afb467b78d47edd.png" alt="\| \cdot \|"/>
is the Frobenius norm.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>gof</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The goodness of fit with the recorded data.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.plot_source_amplitudes">
<span class="sig-name descname"><span class="pre">plot_source_amplitudes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.plot_source_amplitudes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.plot_source_amplitudes" title="Link to this definition">¶</a></dt>
<dd><p>Plot the  amplitude of the estimated sources as function of time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.plot_sources">
<span class="sig-name descname"><span class="pre">plot_sources</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_open</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.plot_sources"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.plot_sources" title="Link to this definition">¶</a></dt>
<dd><p>Plot the estimated sources. The default behaviour of the method is the following:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">Sesame</span></code> has been instantiated through <a class="reference internal" href="sesameeg.mne.prepare_sesame.html#sesameeg.mne.prepare_sesame" title="sesameeg.mne.prepare_sesame"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_sesame()</span></code></a>, it visualizes the posterior map of the dipoles’ location and the estimated sources</p>
<ul>
<li><p>on the inflated brain, if <code class="docutils literal notranslate"><span class="pre">Sesame.forward</span></code> is of kind <code class="docutils literal notranslate"><span class="pre">surface</span></code>;</p></li>
<li><p>on the MRI, if <code class="docutils literal notranslate"><span class="pre">Sesame.forward</span></code> is of kind <code class="docutils literal notranslate"><span class="pre">volume</span></code>.</p></li>
</ul>
</li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">Sesame</span></code> has been instantiated through <a class="reference internal" href="#sesameeg.Sesame" title="sesameeg.Sesame"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sesame</span></code></a>, it visualizes the posterior map of the dipoles’ location and the estimated sources as a <a class="reference external" href="https://docs.pyvista.org/version/stable/api/core/_autosummary/pyvista.PolyData.html#pyvista.PolyData" title="(in PyVista v0.42.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">PolyData</span></code></a> object.</p></li>
</ul>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>plot_kwargs</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | None</span></dt><dd><p>Additional arguments to <a class="reference external" href="https://mne.tools/stable/generated/mne.viz.plot_source_estimates.html#mne.viz.plot_source_estimates" title="(in MNE v1.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_source_estimates()</span></code></a> or
<a class="reference external" href="https://nilearn.github.io/stable/modules/generated/nilearn.plotting.plot_stat_map.html#nilearn.plotting.plot_stat_map" title="(in Nilearn)"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_stat_map()</span></code></a> (e.g., dict(surface=’white’)).</p>
</dd>
<dt><strong>savepath</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>File path to write image to. If None, no image is written.</p>
</dd>
<dt><strong>save_kwargs</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | None</span></dt><dd><p>Additional arguments to <a class="reference external" href="https://docs.pyvista.org/version/stable/api/plotting/_autosummary/pyvista.Plotter.screenshot.html#pyvista.Plotter.screenshot" title="(in PyVista v0.42.1)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">screenshot()</span></code></a>
or <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.savefig.html#matplotlib.pyplot.savefig" title="(in Matplotlib v3.8.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">savefig()</span></code></a>.</p>
</dd>
<dt><strong>true_sources</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.26)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> | None</span></dt><dd><p>In simulation settings, indexes of source space points in which true sources are located.</p>
</dd>
<dt><strong>force_open</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True, force the image to stay open.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.save_h5">
<span class="sig-name descname"><span class="pre">save_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbj_viz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lf_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.save_h5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.save_h5" title="Link to this definition">¶</a></dt>
<dd><p>Save SESAME result to an HDF5 file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>fpath</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>The path to the save file.</p>
</dd>
<dt><strong>sbj</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The subject name.</p>
</dd>
<dt><strong>sbj_viz</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The name of the subject’s FreeSurfer folder.</p>
</dd>
<dt><strong>data_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the data file.</p>
</dd>
<dt><strong>fwd_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the forward solution file.</p>
</dd>
<dt><strong>cov_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the noise covariance file.</p>
</dd>
<dt><strong>src_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the source space file.</p>
</dd>
<dt><strong>lf_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the leadfield matrix file.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.save_pkl">
<span class="sig-name descname"><span class="pre">save_pkl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sbj_viz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwd_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lf_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.save_pkl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.save_pkl" title="Link to this definition">¶</a></dt>
<dd><p>Save SESAME result to a Python pickle file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>fpath</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>The path to the save file.</p>
</dd>
<dt><strong>sbj</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The subject name.</p>
</dd>
<dt><strong>sbj_viz</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The name of the subject’s FreeSurfer folder.</p>
</dd>
<dt><strong>data_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the data file.</p>
</dd>
<dt><strong>fwd_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the forward solution file.</p>
</dd>
<dt><strong>cov_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the noise covariance file.</p>
</dd>
<dt><strong>src_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the source space file.</p>
</dd>
<dt><strong>lf_path</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | None</span></dt><dd><p>The path to the leadfield matrix file.</p>
</dd>
<dt><strong>save_all</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></dt><dd><p>If True, save the data and the forward model. Default to False.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sesameeg.Sesame.source_dispersion">
<span class="sig-name descname"><span class="pre">source_dispersion</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sesameeg/sesame.html#Sesame.source_dispersion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sesameeg.Sesame.source_dispersion" title="Link to this definition">¶</a></dt>
<dd><p>Compute the Source Dispersion measure to quantify the spatial dispersion
of the posterior probability map. It is defined as</p>
<blockquote>
<div><div class="math">
<p><img src="../_images/math/5f7843ddda9d67a70a044c5db8eb970561c2d5ed.png" alt="SD = \sqrt{\frac{\sum_{j=1}^{N_v} \big(d_j |S_j|\big)^2}{\sum_{j=1}^{N_v}|S_j|^2}}"/></p>
</div></div></blockquote>
<p>where <img class="math" src="../_images/math/6c038ecad945fdd2cf11beb34d0beb5527bd5118.png" alt="N_v"/> is the number of voxels, <img class="math" src="../_images/math/40b2016b0a343a9ecd6b8c92a5dc4716f58cfe32.png" alt="d_j"/> is the distance between the <img class="math" src="../_images/math/e3fc28292267f066fee7718c64f4bbfece521f24.png" alt="j"/>-th voxel
and the nearest estimated dipole location and <img class="math" src="../_images/math/3f0caa176732b3d0f771a8eed43c4f4a6b24ca8c.png" alt="S_j"/> is the value of the cortical map at
the <img class="math" src="../_images/math/e3fc28292267f066fee7718c64f4bbfece521f24.png" alt="j"/>-th voxel.</p>
<dl class="field-list">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>sd</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></dt><dd><p>The Source Dispersion of SESAME result</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="examples-using-sesameeg-sesame">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">sesameeg.Sesame</span></code><a class="headerlink" href="#examples-using-sesameeg-sesame" title="Link to this heading">¶</a></h2>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="In this example we shall apply SESAME on an evoked dataset, corresponding to the response to an..."><img alt="" src="../_images/sphx_glr_plot_compute_sesame_meg_auditory_mne_thumb.png" />
<p><a class="reference internal" href="../auto_examples/plot_compute_sesame_meg_auditory_mne.html#sphx-glr-auto-examples-plot-compute-sesame-meg-auditory-mne-py"><span class="std std-ref">Compute SESAME inverse solution on evoked data</span></a></p>
  <div class="sphx-glr-thumbnail-title">Compute SESAME inverse solution on evoked data</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this example we shall apply SESAME on an evoked dataset, corresponding to the response to an..."><img alt="" src="../_images/sphx_glr_plot_compute_sesame_meg_auditory_fixed_ori_mne_thumb.png" />
<p><a class="reference internal" href="../auto_examples/plot_compute_sesame_meg_auditory_fixed_ori_mne.html#sphx-glr-auto-examples-plot-compute-sesame-meg-auditory-fixed-ori-mne-py"><span class="std std-ref">Compute SESAME inverse solution on evoked data with source constraints</span></a></p>
  <div class="sphx-glr-thumbnail-title">Compute SESAME inverse solution on evoked data with source constraints</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this example we shall apply SESAME on an evoked dataset, corresponding to the response to an..."><img alt="" src="../_images/sphx_glr_plot_compute_sesame_meg_auditory_prior_mne_thumb.png" />
<p><a class="reference internal" href="../auto_examples/plot_compute_sesame_meg_auditory_prior_mne.html#sphx-glr-auto-examples-plot-compute-sesame-meg-auditory-prior-mne-py"><span class="std std-ref">Compute SESAME inverse solution on evoked data with given source location prior</span></a></p>
  <div class="sphx-glr-thumbnail-title">Compute SESAME inverse solution on evoked data with given source location prior</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In this example we shall compute SESAME inverse solution on evoked data in a volume source spac..."><img alt="" src="../_images/sphx_glr_plot_compute_sesame_meg_auditory_volume_mne_thumb.png" />
<p><a class="reference internal" href="../auto_examples/plot_compute_sesame_meg_auditory_volume_mne.html#sphx-glr-auto-examples-plot-compute-sesame-meg-auditory-volume-mne-py"><span class="std std-ref">Compute SESAME inverse solution on evoked data in volume source space</span></a></p>
  <div class="sphx-glr-thumbnail-title">Compute SESAME inverse solution on evoked data in volume source space</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In the present example we shall devise a synthetic scenario in which two dipolar sources are ac..."><img alt="" src="../_images/sphx_glr_plot_compute_sesame_meg_simulated_frequency_mne_thumb.png" />
<p><a class="reference internal" href="../auto_examples/plot_compute_sesame_meg_simulated_frequency_mne.html#sphx-glr-auto-examples-plot-compute-sesame-meg-simulated-frequency-mne-py"><span class="std std-ref">Compute SESAME inverse solution on simulated data in the frequency domain</span></a></p>
  <div class="sphx-glr-thumbnail-title">Compute SESAME inverse solution on simulated data in the frequency domain</div>
</div></div><div style='clear:both'></div></section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2023, SESAMEEG developers.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>